<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>食券販売アプリ</title>
  <style>
    
    @import url('https://fonts.googleapis.com/css2?family=Murecho:wght@400;700&display=swap');
body{font-family:Murecho,sans-serif;}
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      text-align: center;
      background-color: #e3a688;
    }

    body {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .total {
      font-size: 60px;
      border: 2px solid #333;
      padding: 0px;
      width: 94%;
      background-color: #f9f5f5;
      margin-bottom: 30px;
    }

    .buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      width: 100vw;
      max-width: 1000px;
      margin-bottom: 30px;
    }

.item-btn {
  width: 45%;
  height: auto;
  font-size: 18px;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 10px;
  gap: 10px;
  border-radius: 10px;
}
    button {
      background-color:#ffffff00;
      border: none;
    }
    button:hover {
      background-color:#ffffff11;
    }
    button:active{
      background-color:#00000011;
    }

.item-btn > button:first-child {
  width: 105%;
  height: 25vh;
  font-size: 50px;
}

.item-btn button:last-child {
  background-color: #ff7777;
  color: white;
  border: none;
  padding: 10px;
  width: 100%;
  font-size: 16px;
  cursor: pointer;
}


    .count {
      position: absolute;
      top: 5px;
      right: 10px;
      background: #ff4444;
      color: white;
      border-radius: 10%;
      width: 50px;
      height: 50px;
      line-height: 30px;
      font-size: 34px;
    }
    #b1 {background-color:#80bfb5}
    #b2 {background-color:#9e6d36}
    #b3 {background-color:#d67ea2}
    #b4 {background-color:#4ea651}
    #resetBtn {
      font-size: 30px;
      padding: 10px 20px;
      border: solid;
    }
    #dbBtn {
      font-size:30px;
      padding: 5px 20px;
      border:solid;
      background-color:#3fd17e66;
    }
    #sendBtn {
      font-size:30px;
      padding: 5px 20px;
      border:solid;
      background-color:#ff564a;
    }
  </style>
</head>
<body>

  <div class="total">合計: ¥<span id="total">0</span></div>

<div class="buttons">
  <div class="item-btn" id="b1">
    <button onclick="addItem('plain')">プレーン ¥150</button>
    <span class="count" id="plainCount">0</span>
    <button onclick="removeItem('plain')">1つキャンセル</button>
  </div>
  <div class="item-btn" id="b2">
    <button onclick="addItem('choco')">チョコアイス ¥250</button>
    <span class="count" id="chocoCount">0</span>
    <button onclick="removeItem('choco')">1つキャンセル</button>
  </div>
  <div class="item-btn" id="b3">
    <button onclick="addItem('strawberry')">いちごアイス ¥250</button>
    <span class="count" id="strawberryCount">0</span>
    <button onclick="removeItem('strawberry')">1つキャンセル</button>
  </div>
  <div class="item-btn" id="b4">
    <button onclick="addItem('matcha')">抹茶あんこアイス ¥250</button>
    <span class="count" id="matchaCount">0</span>
    <button onclick="removeItem('matcha')">1つキャンセル</button>
  </div>
</div>

<div class="buttons">
  <button id="resetBtn" onclick="resetAll()">リセット</button>
  <button id="dbBtn" onclick="location.href='https://docs.google.com/spreadsheets/d/1rJj1GMGcRV4MXAvEyhgI9jZMvGzNmJudf3AB-H_BXJs/edit?usp=sharing'">データベース</button>
<button id="sendBtn" onclick="sendDataToSheet()">
  <b>注文を送信</b>
</button>
  </div>
  <script>
    const items = {
      plain: { price: 150, count: 0 },
      choco: { price: 250, count: 0 },
      strawberry: { price: 250, count: 0 },
      matcha: { price: 250, count: 0 }
    };

    function addItem(key) {
      items[key].count++;
      updateDisplay();
    }

    function updateDisplay() {
      let total = 0;
      for (const key in items) {
        const item = items[key];
        document.getElementById(key + 'Count').textContent = item.count;
        total += item.price * item.count;
      }
      document.getElementById('total').textContent = total;
    }

    function resetAll() {
      for (const key in items) {
        items[key].count = 0;
      }
      updateDisplay();
    }
function removeItem(key) {
  if (items[key].count > 0) {
    items[key].count--;
    updateDisplay();
  }
}

    function sendDataToSheet() {
  const data = {
    plain: items.plain.count,
    choco: items.choco.count,
    strawberry: items.strawberry.count,
    matcha: items.matcha.count,
    total: Object.keys(items).reduce((sum, key) => sum + items[key].price * items[key].count, 0)
  };

  fetch('https://script.google.com/macros/s/AKfycbwWpH5zf4QTAiTOkqI5xHhi_5wIfQut_PY9U6XfMIWemUGZ20mApr9EXdSe1Ip6FGYz/exec', {
    method: 'POST',
    mode: 'no-cors',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(data)
  }).then(() => {
    alert("注文を記録しました！");
    resetAll();
  }).catch(() => {
    alert("送信に失敗しました。");
  });
}
  </script>

</body>
</html>
